# ============================================================================
# üöÄ PRODUCTION ENVIRONMENT - ShopFlow Backend
# ============================================================================
# Este template deve ser usado como base para configura√ß√£o de produ√ß√£o.
# NUNCA commite este arquivo com valores reais preenchidos!
#
# DEPLOY EM PRODU√á√ÉO:
# 1. Configure estas vari√°veis no secrets manager da sua plataforma:
#    - Railway: railway variables set VARIABLE_NAME="value"
#    - Heroku: heroku config:set VARIABLE_NAME="value"
#    - Docker: use docker secrets ou environment variables
# 2. Valide que TODAS as vari√°veis obrigat√≥rias est√£o configuradas
# 3. Execute testes antes do deploy
# ============================================================================

# ============================================================================
# üîê SUPABASE (OBTER DO SECRETS MANAGER)
# ============================================================================
# ‚ö†Ô∏è NUNCA hardcode estas credenciais - use vari√°veis de ambiente ou secrets
SUPABASE_URL=${SUPABASE_URL}
SUPABASE_SERVICE_KEY=${SUPABASE_SERVICE_KEY}

# ============================================================================
# üîí SECURITY - PRODUCTION MODE
# ============================================================================
# OBRIGAT√ìRIO: Defina como production
ENVIRONMENT=production

# OBRIGAT√ìRIO: Seu dom√≠nio de produ√ß√£o (SEM https://)
# Exemplo: shopflow.com (sistema adicionar√° automaticamente https:// e www.)
PRODUCTION_DOMAIN=seu-dominio.com

# ============================================================================
# üì° API SERVER
# ============================================================================
API_HOST=0.0.0.0
API_PORT=8001
API_DEBUG=False

# IMPORTANTE: Gere uma chave secreta forte e √∫nica para produ√ß√£o
# Comando para gerar: python -c "import secrets; print(secrets.token_urlsafe(32))"
API_SECRET_KEY=${API_SECRET_KEY}

# ============================================================================
# üé• CAMERA RTSP
# ============================================================================
# Configure com IP p√∫blico ou URL acess√≠vel do servidor
CAMERA_RTSP_URL=${CAMERA_RTSP_URL}
CAMERA_FPS_PROCESS=5
CAMERA_RECONNECT_TIMEOUT=10

# ============================================================================
# ü§ñ AI/ML MODELS
# ============================================================================
YOLO_MODEL=yolo11n.pt
YOLO_CONFIDENCE=0.5
YOLO_IOU=0.45
YOLO_DEVICE=cpu  # Mude para 'cuda' se tiver GPU dispon√≠vel

# ============================================================================
# üé≠ FACE RECOGNITION & PRIVACY
# ============================================================================
FACE_RECOGNITION_ENABLED=true
FACE_TOLERANCE=0.6

# ============================================================================
# üë• TRACKING & COUNTING
# ============================================================================
TRACKING_MAX_DISAPPEARED=30
TRACKING_MAX_DISTANCE=50.0
LINE_POSITION=50

# ============================================================================
# üë®‚Äçüë©‚Äçüëß‚Äçüë¶ GROUP DETECTION
# ============================================================================
GROUP_MAX_DISTANCE=1.5
GROUP_MIN_SIZE=2

# ============================================================================
# üíæ STORAGE - PRODUCTION OPTIMIZED
# ============================================================================
UPLOAD_DIR=./uploads
MAX_UPLOAD_SIZE=10485760
SNAPSHOT_RETENTION_DAYS=3  # Reduzido para economizar espa√ßo em produ√ß√£o

# IMPORTANTE: Desabilite snapshots em produ√ß√£o para economizar espa√ßo
# Habilite apenas se necess√°rio e configure limpeza autom√°tica
SAVE_SNAPSHOTS=false

# ============================================================================
# üóÑÔ∏è REDIS (Se usar cache em produ√ß√£o)
# ============================================================================
REDIS_URL=${REDIS_URL:-redis://localhost:6379/0}
REDIS_PASSWORD=${REDIS_PASSWORD}

# ============================================================================
# üìù LOGGING - PRODUCTION
# ============================================================================
LOG_LEVEL=INFO  # Use WARNING ou ERROR para reduzir volume de logs
LOG_FILE=logs/backend.log

# ============================================================================
# üìä MONITORING
# ============================================================================
PROMETHEUS_ENABLED=True
PROMETHEUS_PORT=8090
HEALTH_CHECK_ENABLED=True

# ============================================================================
# üîå WEBSOCKET
# ============================================================================
WS_MAX_CONNECTIONS=100
WS_HEARTBEAT_INTERVAL=30

# ============================================================================
# üöÄ DEPLOY CHECKLIST
# ============================================================================
# Antes de fazer deploy, verifique:
#
# ‚úÖ SUPABASE_SERVICE_KEY est√° em secrets (n√£o hardcoded)
# ‚úÖ ENVIRONMENT=production
# ‚úÖ PRODUCTION_DOMAIN configurado corretamente
# ‚úÖ API_SECRET_KEY gerada (n√£o use o padr√£o)
# ‚úÖ CORS restrito ao dom√≠nio de produ√ß√£o
# ‚úÖ RLS (Row Level Security) habilitado no Supabase
# ‚úÖ Service key rotacionada recentemente
# ‚úÖ Logs estruturados habilitados
# ‚úÖ HTTPS obrigat√≥rio (configurado no reverse proxy/load balancer)
# ‚úÖ Rate limiting configurado (se dispon√≠vel)
# ‚úÖ Backup do banco de dados configurado
# ‚úÖ Monitoramento configurado (Prometheus/Grafana)
# ‚úÖ Alertas configurados para erros cr√≠ticos
#
# ============================================================================
# üìö PLATFORM-SPECIFIC INSTRUCTIONS
# ============================================================================

# RAILWAY:
# -------
# railway variables set SUPABASE_URL="https://..."
# railway variables set SUPABASE_SERVICE_KEY="eyJ..."
# railway variables set ENVIRONMENT="production"
# railway variables set PRODUCTION_DOMAIN="seu-dominio.com"
# railway variables set API_SECRET_KEY="$(python -c 'import secrets; print(secrets.token_urlsafe(32))')"
# railway up

# HEROKU:
# -------
# heroku config:set SUPABASE_URL="https://..."
# heroku config:set SUPABASE_SERVICE_KEY="eyJ..."
# heroku config:set ENVIRONMENT="production"
# heroku config:set PRODUCTION_DOMAIN="seu-dominio.com"
# heroku config:set API_SECRET_KEY="$(python -c 'import secrets; print(secrets.token_urlsafe(32))')"
# git push heroku main

# DOCKER:
# -------
# Use docker secrets ou pass vari√°veis via docker-compose.yml:
# environment:
#   - SUPABASE_URL=${SUPABASE_URL}
#   - SUPABASE_SERVICE_KEY=${SUPABASE_SERVICE_KEY}
#   - ENVIRONMENT=production
#   - PRODUCTION_DOMAIN=seu-dominio.com

# VPS/VM:
# -------
# 1. Crie .env.production com os valores reais
# 2. Defina permiss√µes: chmod 600 .env.production
# 3. Configure systemd/supervisor para carregar o arquivo
# 4. NUNCA commite .env.production no Git

# ============================================================================
# üîê SECURITY REMINDERS
# ============================================================================
# - Rotacione SUPABASE_SERVICE_KEY a cada 30-90 dias
# - Nunca logue a service key completa
# - Use HTTPS em produ√ß√£o (configure no nginx/caddy)
# - Habilite rate limiting no reverse proxy
# - Configure firewall para permitir apenas IPs necess√°rios
# - Monitore logs para tentativas de acesso n√£o autorizado
# - Configure backup autom√°tico do Supabase
# - Teste recupera√ß√£o de desastres regularmente
# ============================================================================
