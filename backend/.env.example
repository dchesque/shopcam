# ============================================================================
# ShopFlow Backend - Environment Configuration
# ============================================================================
# Copy this file to .env.local and fill with your actual values
#
#   cp .env.example .env.local
#
# NEVER commit .env or .env.local to git!
# Add to .gitignore: .env, .env.local, .env.production
#
# ============================================================================
# üîê SUPABASE CONFIGURATION (CR√çTICO - NUNCA COMMITAR)
# ============================================================================

# Supabase Project URL
# Get from: https://app.supabase.com/project/[PROJECT_ID]/settings/api
SUPABASE_URL=https://your-project-id.supabase.co

# Supabase Anon Key (public, safe to expose no frontend)
# Get from: https://app.supabase.com/project/[PROJECT_ID]/settings/api
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.XXXX

# ‚ö†Ô∏è SUPABASE SERVICE KEY - EXTREMAMENTE SENS√çVEL ‚ö†Ô∏è
# - NUNCA exponha esta chave no frontend ou em c√≥digo p√∫blico
# - NUNCA commite no Git (verifique .gitignore)
# - Tem privil√©gios ADMINISTRATIVOS totais sobre o banco
# - Use secrets manager em produ√ß√£o (Railway Secrets, Heroku Config Vars, etc)
# - Rotacione regularmente via Supabase Dashboard ‚Üí Settings ‚Üí API
# Get from: https://app.supabase.com/project/[PROJECT_ID]/settings/api
SUPABASE_SERVICE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.XXXX

# ============================================================================
# REQUIRED: API Server
# ============================================================================

# API Host (0.0.0.0 for external connections, 127.0.0.1 for localhost only)
API_HOST=0.0.0.0

# API Port
API_PORT=8001

# Debug mode (False for production)
API_DEBUG=False

# Secret key for API (change this in production!)
API_SECRET_KEY=change-me-in-production-with-a-secure-random-key

# ============================================================================
# üîí SECURITY & ENVIRONMENT
# ============================================================================

# Environment: development | staging | production
# IMPORTANTE: Define como CORS e valida√ß√µes ser√£o configuradas
ENVIRONMENT=development

# Production Domain (OBRIGAT√ìRIO em production)
# Apenas o dom√≠nio, SEM https:// (ser√° adicionado automaticamente)
# Exemplo: shopflow.com (sistema permite https://shopflow.com e https://www.shopflow.com)
PRODUCTION_DOMAIN=

# CORS: Origens permitidas ser√£o definidas automaticamente baseado no ENVIRONMENT:
# - development: localhost:3000, localhost:3001, 127.0.0.1:3000, 127.0.0.1:3001
# - staging: localhost + https://staging.{PRODUCTION_DOMAIN}
# - production: APENAS https://{PRODUCTION_DOMAIN} e https://www.{PRODUCTION_DOMAIN}
#
# ‚ö†Ô∏è NUNCA use wildcard (*) em produ√ß√£o - o sistema bloquear√° a inicializa√ß√£o

# ============================================================================
# REQUIRED: Camera RTSP Stream
# ============================================================================

# RTSP URL for camera
# Format: rtsp://username:password@ip:port/stream-path
#
# Examples by brand:
# Intelbras: rtsp://admin:senha@192.168.1.100:554/cam/realmonitor?channel=1&subtype=0
# Hikvision: rtsp://admin:senha@192.168.1.100:554/Streaming/Channels/101
# Dahua:     rtsp://admin:senha@192.168.1.100:554/cam/realmonitor?channel=1&subtype=0
CAMERA_RTSP_URL=rtsp://admin:password@192.168.1.100:554/cam/realmonitor?channel=1&subtype=0

# FPS for processing (lower = better performance, fewer detections)
# Recommended: 5 FPS for local processing
CAMERA_FPS_PROCESS=5

# Reconnection timeout in seconds when camera is disconnected
CAMERA_RECONNECT_TIMEOUT=10

# ============================================================================
# REQUIRED: AI/ML Models
# ============================================================================

# YOLO Model to use
# Options: yolo11n.pt (fastest), yolo11s.pt, yolo11m.pt, yolo11l.pt, yolo11x.pt (most accurate)
# Download automatically on first run
YOLO_MODEL=yolo11n.pt

# Minimum confidence for detections (0.0 to 1.0)
# Higher = fewer false positives, but may miss people
# Recommended: 0.5 to 0.6
YOLO_CONFIDENCE=0.6

# IOU threshold for NMS (Non-Maximum Suppression)
# Lower = more detections, higher = fewer overlapping boxes
YOLO_IOU=0.45

# Device to run YOLO on: cpu, cuda (NVIDIA GPU), mps (Apple Silicon)
YOLO_DEVICE=cpu

# ============================================================================
# OPTIONAL: Face Recognition & Privacy
# ============================================================================

# Enable facial recognition for employee identification
FACE_RECOGNITION_ENABLED=true

# Distance threshold for face recognition (0.0 to 1.0)
# Lower = stricter matching, higher = more permissive
FACE_TOLERANCE=0.6

# ============================================================================
# OPTIONAL: Group Detection
# ============================================================================

# Maximum distance in meters to consider people as a group
GROUP_MAX_DISTANCE=1.5

# Minimum people to form a group
GROUP_MIN_SIZE=2

# ============================================================================
# OPTIONAL: Tracking & Counting
# ============================================================================

# Max frames an object can disappear before being removed from tracking
TRACKING_MAX_DISAPPEARED=30

# Max distance (pixels) to match detections to existing tracks
TRACKING_MAX_DISTANCE=50.0

# Counting line position (0-100, % from top of frame)
LINE_POSITION=50

# ============================================================================
# OPTIONAL: Storage
# ============================================================================

# Directory to store uploads and snapshots
UPLOAD_DIR=./uploads

# Save snapshots of detected people (True/False)
SAVE_SNAPSHOTS=False

# Maximum upload size in bytes (10MB default)
MAX_UPLOAD_SIZE=10485760

# Days to retain snapshots
SNAPSHOT_RETENTION_DAYS=7

# ============================================================================
# OPTIONAL: Redis Cache
# ============================================================================

# Redis connection URL
REDIS_URL=redis://localhost:6379/0

# Redis password (if required)
REDIS_PASSWORD=

# ============================================================================
# OPTIONAL: Logging
# ============================================================================

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Log file path
LOG_FILE=logs/backend.log

# ============================================================================
# OPTIONAL: Monitoring & Health Checks
# ============================================================================

# Enable Prometheus metrics endpoint
PROMETHEUS_ENABLED=True

# Port for Prometheus metrics
PROMETHEUS_PORT=8090

# Enable health check endpoint
HEALTH_CHECK_ENABLED=True

# ============================================================================
# OPTIONAL: WebSocket
# ============================================================================

# Max concurrent WebSocket connections
WS_MAX_CONNECTIONS=100

# Heartbeat interval for keeping connections alive (seconds)
WS_HEARTBEAT_INTERVAL=30

# ============================================================================
# Environment Examples
# ============================================================================

# DEVELOPMENT (Local):
# API_DEBUG=True
# LOG_LEVEL=DEBUG
# SAVE_SNAPSHOTS=True
# YOLO_DEVICE=cpu
# CAMERA_RTSP_URL=rtsp://admin:senha@192.168.1.100:554/...

# PRODUCTION (EasyPanel/VPS):
# API_DEBUG=False
# LOG_LEVEL=INFO
# SAVE_SNAPSHOTS=False
# YOLO_DEVICE=cpu (or cuda if GPU available)
# CAMERA_RTSP_URL=rtsp://admin:senha@REMOTE_IP:554/...

# HIGH PERFORMANCE (GPU):
# YOLO_MODEL=yolo11n.pt
# YOLO_DEVICE=cuda
# CAMERA_FPS_PROCESS=10

# HIGH ACCURACY:
# YOLO_MODEL=yolo11m.pt
# YOLO_CONFIDENCE=0.7
# CAMERA_FPS_PROCESS=3

# ============================================================================
# Security Notes
# ============================================================================
# - NEVER commit .env files with real credentials to git!
# - Use environment variables or secrets management in production
# - Rotate API keys and passwords regularly
# - Use HTTPS/WSS in production
# - Configure firewall to restrict access to API
# - Enable RLS (Row Level Security) in Supabase
